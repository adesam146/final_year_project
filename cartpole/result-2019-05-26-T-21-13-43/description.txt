Running pathwise grad method on sml